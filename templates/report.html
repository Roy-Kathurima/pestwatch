<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>New report - {{ user.fullname }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <div class="logo">PW</div>
        <div>
          <h1>Submit report</h1>
        </div>
      </div>
      <div class="nav">
        <a href="{{ url_for('user_dashboard', user_id=user.id) }}">Back</a>
      </div>
    </div>

    <div class="card">
      <form method="post" enctype="multipart/form-data">
        <label>Title</label>
        <input type="text" name="title" required>
        <label>Description</label>
        <textarea name="description"></textarea>
        <label>Photo (optional)</label>
        <input type="file" name="photo" accept="image/*">
        <label>Latitude</label>
        <input type="text" id="latitude" name="latitude" placeholder="e.g., -1.2921">
        <label>Longitude</label>
        <input type="text" id="longitude" name="longitude" placeholder="e.g., 36.8219">
        <button type="button" class="btn-outline" id="use-location">Use device location</button>
        <div style="height:12px"></div>
        <button type="submit" class="btn">Submit report</button>
      </form>
    </div>
  </div>

<script>
document.getElementById('use-location').addEventListener('click', function(){
  if (!navigator.geolocation) {
    alert('Geolocation not supported by your browser.');
    return;
  }
  this.textContent = 'Getting location...';
  navigator.geolocation.getCurrentPosition(function(pos){
    document.getElementById('latitude').value = pos.coords.latitude.toFixed(6);
    document.getElementById('longitude').value = pos.coords.longitude.toFixed(6);
    document.getElementById('use-location').textContent = 'Use device location';
  }, function(err){
    alert('Could not get location: ' + err.message);
    document.getElementById('use-location').textContent = 'Use device location';
  }, {enableHighAccuracy:true, timeout:10000});
});
</script>
</body>
</html>
